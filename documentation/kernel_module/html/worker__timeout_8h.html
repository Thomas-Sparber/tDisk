<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>tDisk kernel module: worker_timeout.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tDisk kernel module
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_881ab206e10a3ce1a13b73cfff848437.html">kernel_module</a></li><li class="navelem"><a class="el" href="dir_ee0db68b255c9dec9b97c46e52efdc58.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">worker_timeout.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/kthread.h&gt;</code><br />
</div>
<p><a href="worker__timeout_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structworker__timeout__data.html">worker_timeout_data</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This data needs to be handed over by kthread_run to start the timeout worker thread.  <a href="structworker__timeout__data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3a36c6a312bc40fbc0c4e811a20049d0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="worker__timeout_8h.html#a3a36c6a312bc40fbc0c4e811a20049d0">init_thread_work_timeout</a>(work)&#160;&#160;&#160;init_kthread_work((work), NULL);</td></tr>
<tr class="memdesc:a3a36c6a312bc40fbc0c4e811a20049d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">tDisk Driver  <a href="#a3a36c6a312bc40fbc0c4e811a20049d0">More...</a><br /></td></tr>
<tr class="separator:a3a36c6a312bc40fbc0c4e811a20049d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ae03919764e7b224fa7d5ac4624d83982"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="worker__timeout_8h.html#ae03919764e7b224fa7d5ac4624d83982">worker_status</a> { <a class="el" href="worker__timeout_8h.html#ae03919764e7b224fa7d5ac4624d83982a6fadb752f01a49c39c4edda126a97057">next_primary_work</a>, 
<a class="el" href="worker__timeout_8h.html#ae03919764e7b224fa7d5ac4624d83982ad2d529b6be64ff075b4804f43c3ee88e">secondary_work_finished</a>, 
<a class="el" href="worker__timeout_8h.html#ae03919764e7b224fa7d5ac4624d83982a2b799300c8d43b92e5174cda275d7ef9">secondary_work_to_do</a>
 }<tr class="memdesc:ae03919764e7b224fa7d5ac4624d83982"><td class="mdescLeft">&#160;</td><td class="mdescRight">This enum represents the current status of the worker thread.  <a href="worker__timeout_8h.html#ae03919764e7b224fa7d5ac4624d83982">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:ae03919764e7b224fa7d5ac4624d83982"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aeeaf145beeced418bedd6922339af97c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="worker__timeout_8h.html#aeeaf145beeced418bedd6922339af97c">kthread_worker_fn_timeout</a> (void *worker_ptr)</td></tr>
<tr class="memdesc:aeeaf145beeced418bedd6922339af97c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is more or less copied from the linux kernel version except that it is able to wake up after a specific timeout, even if there is no work to do.  <a href="#aeeaf145beeced418bedd6922339af97c">More...</a><br /></td></tr>
<tr class="separator:aeeaf145beeced418bedd6922339af97c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdf7d2e8ff5e302d8f0b19d5c0e92058"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="worker__timeout_8h.html#acdf7d2e8ff5e302d8f0b19d5c0e92058">flush_kthread_worker_timeout</a> (struct kthread_worker *worker)</td></tr>
<tr class="memdesc:acdf7d2e8ff5e302d8f0b19d5c0e92058"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flushes the given worker thread.  <a href="#acdf7d2e8ff5e302d8f0b19d5c0e92058">More...</a><br /></td></tr>
<tr class="separator:acdf7d2e8ff5e302d8f0b19d5c0e92058"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a3a36c6a312bc40fbc0c4e811a20049d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define init_thread_work_timeout</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">work</td><td>)</td>
          <td>&#160;&#160;&#160;init_kthread_work((work), NULL);</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>tDisk Driver </p>
<dl class="section author"><dt>Author</dt><dd>Thomas Sparber (2015-2016) Initializes a kthread_work to be used with a timeout_worker </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ae03919764e7b224fa7d5ac4624d83982"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="worker__timeout_8h.html#ae03919764e7b224fa7d5ac4624d83982">worker_status</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This enum represents the current status of the worker thread. </p>
<p>It is returned from the user specific worker function and is used to decide about sleeping times. Normally it looks like this: Primary work (which is the work represented by struct kthread_work) always has the higher priority. If there is primary work to be done, it is done before any secondary work even if there is still some secondary work to do. When the function is called to do some primary work it usually should return next_primary_work to wait for the next primary work. If there is no primary work within the given timeout, the work function is called to do some secondary work then the worker function should either return secondary_work_finished or secondary_work_to_do. If secondary_work_to_do is returned, the worker function is immediately called again to do secondary work. Of course, only if there is no primary work to be done .If secondary_work_finished is returned. The thread goes to sleep and is only woken up if there is primary work to be done... </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ae03919764e7b224fa7d5ac4624d83982a6fadb752f01a49c39c4edda126a97057"></a>next_primary_work&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ae03919764e7b224fa7d5ac4624d83982ad2d529b6be64ff075b4804f43c3ee88e"></a>secondary_work_finished&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ae03919764e7b224fa7d5ac4624d83982a2b799300c8d43b92e5174cda275d7ef9"></a>secondary_work_to_do&#160;</td><td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="acdf7d2e8ff5e302d8f0b19d5c0e92058"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flush_kthread_worker_timeout </td>
          <td>(</td>
          <td class="paramtype">struct kthread_worker *&#160;</td>
          <td class="paramname"><em>worker</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flushes the given worker thread. </p>

</div>
</div>
<a class="anchor" id="aeeaf145beeced418bedd6922339af97c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kthread_worker_fn_timeout </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>worker_ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is more or less copied from the linux kernel version except that it is able to wake up after a specific timeout, even if there is no work to do. </p>
<p>This makes it possible to do some background (secondary) work when there is nothing to do. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 22 2016 17:48:58 for tDisk kernel module by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
